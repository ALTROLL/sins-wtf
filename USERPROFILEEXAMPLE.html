<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ALTROLL | Profile</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: url('https://r2.guns.lol/6cccb35b-0e5b-4029-97d6-be1304681396.png') 16 16, auto !important;
        }

        ::-moz-selection {
            background: #FFFFFF;
            color: #000000;
        }
        ::selection {
            background: #FFFFFF;
            color: #000000;
        }

        body {
            font-family: 'Fira Code', monospace;
            background-color: #000000;
            color: #FFFFFF;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Video Background */
        .video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
        }

        .video-background video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Night time effect overlay */
        .night-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, transparent 0%, rgba(0, 0, 0, 0.4) 100%);
            pointer-events: none;
            z-index: -1;
        }

        /* Click to enter overlay */
        .enter-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: pointer;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .enter-overlay.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .enter-text {
            font-size: 29px;
            font-weight: 700;
            color: #FFFFFF;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Main container */
        .main-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            opacity: 0;
            transform: scaleY(0.8);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .main-container.visible {
            opacity: 1;
            transform: scaleY(1);
        }

        /* Profile card */
        .profile-card {
            background: rgba(27, 27, 27, 0.21);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.168);
            border-radius: 22px;
            padding: 26px;
            max-width: 44rem;
            width: 100%;
            text-align: center;
            transform-style: preserve-3d;
            transition: transform 0.05s ease-out, box-shadow 0.05s ease-out;
            will-change: transform, box-shadow;
        }

        /* Audio reactive glow effect */
        .profile-card.audio-reactive {
            box-shadow: 0 0 var(--glow-size, 20px) var(--glow-color, rgba(255, 255, 255, 0.3));
        }

        /* Avatar */
        .avatar-container {
            margin-bottom: 15px;
        }

        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.189);
            object-fit: cover;
        }

        /* Username */
        .username-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .username {
            font-size: 34px;
            font-weight: 550;
            line-height: 41px;
            color: #FFFFFF;
            text-shadow: 0px 0px 16.5px #FFFFFF;
            background-image: url('https://assets.guns.lol/sparkle_white.gif');
            -webkit-background-clip: text;
            background-clip: text;
        }

        .premium-badge {
            color: #ffffff;
            filter: drop-shadow(#ffffff 0 0 2.5px);
            font-size: 18px;
        }

        /* Typewriter */
        .typewriter-container {
            font-size: 15.5px;
            font-weight: 570;
            min-height: 24px;
            margin-bottom: 8px;
        }

        .typewriter {
            display: inline;
        }

        .cursor {
            display: inline-block;
            width: 2px;
            height: 1em;
            background-color: #FFFFFF;
            margin-left: 2px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* Join date */
        .join-date {
            font-size: 13px;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 20px;
        }

        /* Discord Presence */
        .discord-widget {
            background: rgba(27, 27, 27, 0.2);
            border: 2px solid rgba(27, 27, 27, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: left;
        }

        .discord-widget-header {
            display: flex;
            align-items: center;
            gap: 8px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .discord-widget-header svg {
            width: 20px;
            height: 20px;
        }

        .discord-status {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 12px;
        }

        .discord-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            position: relative;
        }

        .discord-avatar img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
        }

        .status-indicator {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 3px solid rgba(27, 27, 27, 0.5);
        }

        .status-online { background-color: #3ba55c; }
        .status-idle { background-color: #faa61a; }
        .status-dnd { background-color: #ed4245; }
        .status-offline { background-color: #747f8d; }

        .discord-info {
            flex: 1;
        }

        .discord-username {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
        }

        .discord-status-text {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
        }

        .discord-activity {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .activity-header {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 8px;
        }

        .activity-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .activity-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
        }

        .activity-details h4 {
            font-size: 14px;
            font-weight: 600;
            color: #FFFFFF;
        }

        .activity-details p {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Social links */
        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .social-link {
            width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: transparent;
            color: #948f8f;
            text-decoration: none;
            transition: all 0.3s ease;
            filter: drop-shadow(#948f8f 1px 0 7px);
        }

        .social-link:hover {
            transform: scale(1.1);
            color: #FFFFFF;
        }

        .social-link svg {
            width: 22px;
            height: 22px;
        }

        /* Cat cursor effect */
        #oneko {
            width: 32px;
            height: 32px;
            position: fixed;
            pointer-events: none;
            background-image: url('https://raw.githubusercontent.com/adryd325/oneko.js/main/oneko.gif');
            image-rendering: pixelated;
            overflow: hidden;
            z-index: 9999;
        }

        /* Responsive */
        @media (max-width: 720px) {
            .profile-card {
                padding: 20px;
            }
            
            .username {
                font-size: 28px;
            }
        }

        /* Loading animation for discord widget */
        .loading-shimmer {
            background: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        /* Audio Debug Graph */
        #audioGraph {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 400px;
            height: 200px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            z-index: 9999;
            padding: 10px;
            font-family: monospace;
            font-size: 11px;
            color: #fff;
            display: none;
        }
        #audioGraph.visible {
            display: block;
        }
        #audioGraph canvas {
            width: 100%;
            height: 140px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
        }
        #audioGraph .stats {
            margin-top: 8px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 5px;
        }
        #audioGraph .stat {
            background: rgba(255,255,255,0.1);
            padding: 3px 8px;
            border-radius: 4px;
        }
        #audioGraph .stat.bass { color: #ff6b6b; }
        #audioGraph .stat.mid { color: #4ecdc4; }
        #audioGraph .stat.high { color: #ffe66d; }
        #audioGraph .stat.beat { color: #ff00ff; }
        #toggleGraph {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            z-index: 9999;
            font-family: monospace;
            font-size: 12px;
        }
        #toggleGraph:hover {
            background: rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>
    <!-- Video Background -->
    <div class="video-background">
        <video id="bgVideo" loop playsinline>
            <source src="Speed_x_Ronaldo_-_The_GOAT__His_Biggest_Fan_EDIT_4K.mp4" type="video/mp4">
        </video>
    </div>

    <!-- Night overlay effect -->
    <div class="night-overlay"></div>

    <!-- Click to enter overlay -->
    <div class="enter-overlay" id="enterOverlay">
        <div class="enter-text">click to enter...</div>
    </div>

    <!-- Main content -->
    <div class="main-container" id="mainContainer">
        <div class="profile-card" id="profileCard">
            <!-- Avatar -->
            <div class="avatar-container">
                <img src="https://r2.guns.lol/43c855df-002f-4c0d-99c4-4115e51624b6.png" alt="Avatar" class="avatar" id="avatar">
            </div>

            <!-- Username -->
            <div class="username-container">
                <h1 class="username">ALTROLL</h1>
                <span class="premium-badge" title="Premium">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="23 32 465 448">
                        <path fill="currentColor" d="M396.31 32H264l84.19 112.26L396.31 32zm-280.62 0l48.12 112.26L248 32H115.69zM256 74.67L192 160h128l-64-85.33zm166.95-23.61L376.26 160H488L422.95 51.06zm-333.9 0L23 160h112.74L89.05 51.06zM146.68 192H24l222.8 288h.53L146.68 192zm218.64 0L264.67 480h.53L488 192H365.32zm-35.93 0H182.61L256 400l73.39-208z"></path>
                    </svg>
                </span>
            </div>

            <!-- Typewriter description -->
            <div class="typewriter-container">
                <h3>
                    <span class="typewriter" id="typewriter"></span><span class="cursor"></span>
                </h3>
            </div>

            <!-- Join date -->
            <div class="join-date">Joined 8 months ago</div>

            <!-- Discord Widget -->
            <div class="discord-widget" id="discordWidget">
                <div class="discord-widget-header">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="1.5 4 21 16">
                        <path fill="currentColor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02M8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12m6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12"></path>
                    </svg>
                    <span>Discord Status</span>
                </div>
                <div class="discord-status" id="discordStatus">
                    <div class="discord-avatar">
                        <img src="https://cdn.discordapp.com/avatars/741716507964211352/30110133be1921b6bf479f52c88d1c21.png" alt="Discord Avatar" id="discordAvatar">
                        <div class="status-indicator status-offline" id="statusIndicator"></div>
                    </div>
                    <div class="discord-info">
                        <div class="discord-username" id="discordUsername">altroll</div>
                        <div class="discord-status-text" id="discordStatusText">Offline</div>
                    </div>
                </div>
                <div class="discord-activity" id="discordActivity" style="display: none;">
                    <div class="activity-header">Playing</div>
                    <div class="activity-content">
                        <img src="" alt="" class="activity-image" id="activityImage">
                        <div class="activity-details">
                            <h4 id="activityName"></h4>
                            <p id="activityDetails"></p>
                            <p id="activityState"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Social links -->
            <div class="social-links">
                <a href="#" class="social-link" title="Copy Discord" onclick="copyDiscord(); return false;">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="1.96 4.26 20.03 15.53">
                        <path fill="currentColor" d="M14.82 4.26a10.14 10.14 0 0 0-.53 1.1a14.66 14.66 0 0 0-4.58 0a10.14 10.14 0 0 0-.53-1.1a16 16 0 0 0-4.13 1.3a17.33 17.33 0 0 0-3 11.59a16.6 16.6 0 0 0 5.07 2.59A12.89 12.89 0 0 0 8.23 18a9.65 9.65 0 0 1-1.71-.83a3.39 3.39 0 0 0 .42-.33a11.66 11.66 0 0 0 10.12 0q.21.18.42.33a10.84 10.84 0 0 1-1.71.84a12.41 12.41 0 0 0 1.08 1.78a16.44 16.44 0 0 0 5.06-2.59a17.22 17.22 0 0 0-3-11.59a16.09 16.09 0 0 0-4.09-1.35zM8.68 14.81a1.94 1.94 0 0 1-1.8-2a1.93 1.93 0 0 1 1.8-2a1.93 1.93 0 0 1 1.8 2a1.93 1.93 0 0 1-1.8 2zm6.64 0a1.94 1.94 0 0 1-1.8-2a1.93 1.93 0 0 1 1.8-2a1.92 1.92 0 0 1 1.8 2a1.92 1.92 0 0 1-1.8 2z"></path>
                    </svg>
                </a>
                <a href="https://roblox.com/users/1392202663/profile" target="_blank" class="social-link" title="Roblox">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0.16 0 23.68 24">
                        <path fill="currentColor" d="M5.164 0L.16 18.928L18.836 24L23.84 5.072Zm8.747 15.354l-5.219-1.417l1.399-5.29l5.22 1.418l-1.4 5.29z"></path>
                    </svg>
                </a>
                <a href="https://youtube.com/@altroll-moon" target="_blank" class="social-link" title="YouTube">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="1.99 5 20.01 14.01">
                        <path fill="currentColor" d="M21.593 7.203a2.506 2.506 0 0 0-1.762-1.766C18.265 5.007 12 5 12 5s-6.264-.007-7.831.404a2.56 2.56 0 0 0-1.766 1.778c-.413 1.566-.417 4.814-.417 4.814s-.004 3.264.406 4.814c.23.857.905 1.534 1.763 1.765c1.582.43 7.83.437 7.83.437s6.265.007 7.831-.403a2.515 2.515 0 0 0 1.767-1.763c.414-1.565.417-4.812.417-4.812s.02-3.265-.407-4.831zM9.996 15.005l.005-6l5.207 3.005l-5.212 2.995z"></path>
                    </svg>
                </a>
                <a href="https://x.com/ALTROLL_2" target="_blank" class="social-link" title="X (Twitter)">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="26.8 48 460.2 416">
                        <path fill="currentColor" d="M389.2 48h70.6L305.6 224.2L487 464H345L233.7 318.6L106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"></path>
                    </svg>
                </a>
            </div>
        </div>
    </div>

    <!-- Cat cursor (oneko) -->
    <div id="oneko"></div>

    <!-- Audio Debug Graph -->
    <div id="audioGraph">
        <canvas id="graphCanvas" width="380" height="140"></canvas>
        <div class="stats">
            <span class="stat bass">Bass: <span id="statBass">0</span></span>
            <span class="stat mid">Mid: <span id="statMid">0</span></span>
            <span class="stat high">High: <span id="statHigh">0</span></span>
            <span class="stat beat">Beat: <span id="statBeat">NO</span></span>
            <span class="stat">Baseline: <span id="statBaseline">0</span></span>
        </div>
    </div>
    <button id="toggleGraph">ðŸ“Š Toggle Graph</button>

    <script>
        // ============ CONFIGURATION ============
        // Replace this with your Discord User ID to fetch your status
        const DISCORD_USER_ID = '741716507964211352'; // altroll's Discord ID - replace with yours
        
        // Typewriter texts
        const typewriterTexts = [
            "Advanced Roblox Animator",
            "Low fees",
            "Fast Response Time",
            "TSB CONTRIBUTOR"
        ];
        
        // Typewriter settings
        const typeSpeed = 100;
        const deleteSpeed = 50;
        const pauseTime = 2000;
        
        // ============ AUDIO VISUALIZER - BASS REACTIVE ============
        let audioContext = null;
        let analyser = null;
        let sourceNode = null;
        let dataArray = null;
        let isVisualizerActive = false;
        
        // Smoothing variables for fluid animation
        let smoothBass = 0;
        let smoothMid = 0;
        let smoothOverall = 0;
        let smoothScale = 1;
        let smoothGlow = 20;
        let beatHit = 0;
        
        // Dynamic baseline tracking - adapts to constant bass
        let bassBaseline = 0;
        let midBaseline = 0;
        let peakBass = 0;
        let peakMid = 0;
        
        // Graph history
        let bassHistory = [];
        let midHistory = [];
        let baselineHistory = [];
        const HISTORY_LENGTH = 100;
        
        // Settings - TUNED FOR CONSTANT BASS AUDIO
        const REACTION_SMOOTHING = 0.3;
        const SCALE_SMOOTHING = 0.2;
        const BASELINE_ADAPT_SPEED = 0.001;  // VERY slow adapt - baseline stays low
        const PEAK_DECAY = 0.9995;           // Very slow decay
        
        function initAudioVisualizer() {
            if (isVisualizerActive) return;
            
            const video = document.getElementById('bgVideo');
            const profileCard = document.getElementById('profileCard');
            
            try {
                // Create audio context
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Create analyser node
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 512;
                analyser.smoothingTimeConstant = 0.75;
                
                // Connect video to analyser
                sourceNode = audioContext.createMediaElementSource(video);
                sourceNode.connect(analyser);
                analyser.connect(audioContext.destination);
                
                // Create data array for frequency data
                const bufferLength = analyser.frequencyBinCount;
                dataArray = new Uint8Array(bufferLength);
                
                // Add reactive class
                profileCard.classList.add('audio-reactive');
                
                isVisualizerActive = true;
                
                // Start the visualization loop
                visualize();
                
                console.log('Audio visualizer initialized!');
            } catch (error) {
                console.error('Failed to initialize audio visualizer:', error);
            }
        }
        
        function visualize() {
            if (!isVisualizerActive || !analyser) return;
            
            requestAnimationFrame(visualize);
            
            const profileCard = document.getElementById('profileCard');
            
            // Get frequency data
            analyser.getByteFrequencyData(dataArray);
            
            // Get bass frequencies
            let bass = 0;
            for (let i = 0; i < 15; i++) {
                bass += dataArray[i];
            }
            bass = bass / 15 / 255;
            
            // Get mid frequencies
            let mid = 0;
            for (let i = 15; i < 80; i++) {
                mid += dataArray[i];
            }
            mid = mid / 65 / 255;
            
            // Get overall volume
            let overall = 0;
            for (let i = 0; i < dataArray.length; i++) {
                overall += dataArray[i];
            }
            overall = overall / dataArray.length / 255;
            
            // Update baseline (slowly adapts to average level)
            bassBaseline += (bass - bassBaseline) * BASELINE_ADAPT_SPEED;
            midBaseline += (mid - midBaseline) * BASELINE_ADAPT_SPEED;
            
            // Track peaks
            if (bass > peakBass) peakBass = bass;
            if (mid > peakMid) peakMid = mid;
            peakBass *= PEAK_DECAY;
            peakMid *= PEAK_DECAY;
            
            // Calculate RELATIVE intensity - USE MID FREQUENCIES INSTEAD
            // Since bass is constant (~0.85), we'll react more to mids and highs
            const dynamicRange = Math.max(peakMid - midBaseline, 0.08);
            const relativeMid = Math.max(0, (mid - midBaseline * 0.9) / dynamicRange);
            
            // For bass, use absolute changes (small dips/peaks in the constant bass)
            const bassChange = Math.abs(bass - bassBaseline);
            const relativeBass = bassChange * 10; // Amplify tiny changes
            
            // Clamp
            const activeBass = Math.min(1, Math.max(0, relativeBass));
            const activeMid = Math.min(1, Math.max(0, relativeMid));
            
            // Smooth the values
            smoothBass += (activeBass - smoothBass) * REACTION_SMOOTHING;
            smoothMid += (activeMid - smoothMid) * REACTION_SMOOTHING;
            smoothOverall += (overall - smoothOverall) * REACTION_SMOOTHING;
            
            // Beat detection - look for MID spikes since bass is constant
            if (activeMid > 0.5 || activeBass > 0.3) {
                beatHit = Math.max(beatHit, activeMid > 0.5 ? 1 : 0.6);
            }
            beatHit *= 0.88; // Decay
            
            // SCALE BASED ON ABSOLUTE BASS LEVEL
            // Bass ranges from ~0.3 (quiet) to ~0.9 (loud) in your audio
            // Map this to scale: 0.85 (small) to 1.1 (expanded)
            const bassMin = 0.35;  // Below this = minimum size
            const bassMax = 0.90;  // Above this = maximum size
            const scaleMin = 0.88; // Smallest scale
            const scaleMax = 1.08; // Largest scale
            
            // Normalize bass to 0-1 range within our min/max
            const bassNormalized = Math.max(0, Math.min(1, (bass - bassMin) / (bassMax - bassMin)));
            
            // Calculate target scale
            const baseScale = scaleMin + (bassNormalized * (scaleMax - scaleMin));
            const targetScale = baseScale + (beatHit * 0.06); // Extra punch on beats
            smoothScale += (targetScale - smoothScale) * SCALE_SMOOTHING;
            
            // Movement based on bass level too
            const time = Date.now() / 1000;
            const intensity = bassNormalized * 0.8 + smoothMid * 0.2;
            
            // Sway - scales with bass
            const swayX = Math.sin(time * 2.5) * intensity * 6;
            const swayY = Math.cos(time * 3) * intensity * 4;
            
            // Shake - only when bass is high
            const shakeAmount = bassNormalized > 0.6 ? (bassNormalized * 8 + beatHit * 12) : beatHit * 8;
            const shakeX = (Math.random() - 0.5) * shakeAmount;
            const shakeY = (Math.random() - 0.5) * shakeAmount;
            
            // Rotation - scales with bass
            const rotation = Math.sin(time * 2) * (bassNormalized * 2 + beatHit * 1.5);
            
            // Apply transform
            const translateX = swayX + shakeX;
            const translateY = swayY + shakeY;
            profileCard.style.transform = `perspective(1000px) translate(${translateX}px, ${translateY}px) scale(${smoothScale}) rotate(${rotation}deg)`;
            
            // Glow based on bass level (bigger when loud)
            const targetGlow = 10 + (bassNormalized * 40) + (beatHit * 25);
            smoothGlow += (targetGlow - smoothGlow) * 0.12;
            const glowOpacity = 0.1 + (bassNormalized * 0.5) + (beatHit * 0.2);
            profileCard.style.setProperty('--glow-size', `${smoothGlow}px`);
            profileCard.style.setProperty('--glow-color', `rgba(255, 255, 255, ${Math.min(glowOpacity, 1)})`);
            
            // Border - thicker and brighter when bass is high
            const borderOpacity = 0.15 + (bassNormalized * 0.4) + (beatHit * 0.2);
            const borderWidth = 1.5 + (bassNormalized * 1.5) + (beatHit * 1);
            profileCard.style.borderColor = `rgba(255, 255, 255, ${Math.min(borderOpacity, 1)})`;
            profileCard.style.borderWidth = `${borderWidth}px`;
            
            // ===== DEBUG GRAPH =====
            // Update history
            bassHistory.push(bass);
            midHistory.push(mid);
            baselineHistory.push(bassBaseline);
            if (bassHistory.length > HISTORY_LENGTH) {
                bassHistory.shift();
                midHistory.shift();
                baselineHistory.shift();
            }
            
            // Draw graph if visible
            const graphEl = document.getElementById('audioGraph');
            if (graphEl.classList.contains('visible')) {
                drawGraph(bass, mid, overall, beatHit > 0.5);
                
                // Update stats
                document.getElementById('statBass').textContent = bass.toFixed(3);
                document.getElementById('statMid').textContent = mid.toFixed(3);
                document.getElementById('statHigh').textContent = overall.toFixed(3);
                document.getElementById('statBeat').textContent = beatHit > 0.5 ? 'YES!' : 'no';
                document.getElementById('statBaseline').textContent = bassBaseline.toFixed(3);
            }
        }
        
        function drawGraph(bass, mid, overall, isBeat) {
            const canvas = document.getElementById('graphCanvas');
            const ctx = canvas.getContext('2d');
            const w = canvas.width;
            const h = canvas.height;
            
            // Clear
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.fillRect(0, 0, w, h);
            
            // Draw frequency bars on left side
            const barWidth = 3;
            const barGap = 1;
            const maxBars = 60;
            
            if (dataArray) {
                for (let i = 0; i < maxBars; i++) {
                    const value = dataArray[i] / 255;
                    const barHeight = value * h * 0.8;
                    const x = i * (barWidth + barGap);
                    
                    // Color based on frequency range
                    if (i < 15) {
                        ctx.fillStyle = `rgba(255, 107, 107, ${0.5 + value * 0.5})`; // Bass - red
                    } else if (i < 50) {
                        ctx.fillStyle = `rgba(78, 205, 196, ${0.5 + value * 0.5})`; // Mid - teal
                    } else {
                        ctx.fillStyle = `rgba(255, 230, 109, ${0.5 + value * 0.5})`; // High - yellow
                    }
                    
                    ctx.fillRect(x, h - barHeight, barWidth, barHeight);
                }
            }
            
            // Draw history lines on right side
            const graphStartX = 200;
            const graphWidth = w - graphStartX - 10;
            
            // Background for line graph
            ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
            ctx.fillRect(graphStartX, 0, graphWidth + 10, h);
            
            // Draw baseline
            ctx.beginPath();
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            for (let i = 0; i < baselineHistory.length; i++) {
                const x = graphStartX + (i / HISTORY_LENGTH) * graphWidth;
                const y = h - (baselineHistory[i] * h);
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Draw bass line
            ctx.beginPath();
            ctx.strokeStyle = '#ff6b6b';
            ctx.lineWidth = 2;
            for (let i = 0; i < bassHistory.length; i++) {
                const x = graphStartX + (i / HISTORY_LENGTH) * graphWidth;
                const y = h - (bassHistory[i] * h);
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Draw mid line
            ctx.beginPath();
            ctx.strokeStyle = '#4ecdc4';
            ctx.lineWidth = 1.5;
            for (let i = 0; i < midHistory.length; i++) {
                const x = graphStartX + (i / HISTORY_LENGTH) * graphWidth;
                const y = h - (midHistory[i] * h);
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Beat indicator
            if (isBeat) {
                ctx.fillStyle = 'rgba(255, 0, 255, 0.3)';
                ctx.fillRect(0, 0, w, h);
            }
            
            // Labels
            ctx.fillStyle = '#ff6b6b';
            ctx.font = '10px monospace';
            ctx.fillText('BASS', graphStartX + 5, 12);
            ctx.fillStyle = '#4ecdc4';
            ctx.fillText('MID', graphStartX + 45, 12);
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.fillText('BASELINE', graphStartX + 80, 12);
        }
        
        // Toggle graph visibility
        document.getElementById('toggleGraph').addEventListener('click', () => {
            document.getElementById('audioGraph').classList.toggle('visible');
        });
        
        // ============ CLICK TO ENTER ============
        const enterOverlay = document.getElementById('enterOverlay');
        const mainContainer = document.getElementById('mainContainer');
        const video = document.getElementById('bgVideo');
        
        enterOverlay.addEventListener('click', async () => {
            enterOverlay.classList.add('hidden');
            mainContainer.classList.add('visible');
            if (video) {
                // Initialize audio visualizer BEFORE playing
                initAudioVisualizer();
                
                video.muted = false;
                video.volume = 0.5; // 50% volume, adjust as needed
                
                // Resume audio context (required by browsers)
                if (audioContext && audioContext.state === 'suspended') {
                    await audioContext.resume();
                }
                
                video.play();
            }
        });
        
        // ============ TYPEWRITER EFFECT ============
        const typewriterElement = document.getElementById('typewriter');
        let textIndex = 0;
        let charIndex = 0;
        let isDeleting = false;
        
        function typeWriter() {
            const currentText = typewriterTexts[textIndex];
            
            if (isDeleting) {
                typewriterElement.textContent = currentText.substring(0, charIndex - 1);
                charIndex--;
            } else {
                typewriterElement.textContent = currentText.substring(0, charIndex + 1);
                charIndex++;
            }
            
            let timeout = isDeleting ? deleteSpeed : typeSpeed;
            
            if (!isDeleting && charIndex === currentText.length) {
                timeout = pauseTime;
                isDeleting = true;
            } else if (isDeleting && charIndex === 0) {
                isDeleting = false;
                textIndex = (textIndex + 1) % typewriterTexts.length;
                timeout = 500;
            }
            
            setTimeout(typeWriter, timeout);
        }
        
        typeWriter();
        
        // ============ DISCORD STATUS (using discord.id API) ============
        async function fetchDiscordStatus() {
            try {
                // Using dcdn.dstn.to API (no server join required)
                const response = await fetch(`https://dcdn.dstn.to/profile/${DISCORD_USER_ID}`);
                const data = await response.json();
                
                if (data) {
                    updateDiscordWidgetDstn(data);
                }
            } catch (error) {
                console.error('Failed to fetch Discord status:', error);
                // Fallback: try discord.id API
                try {
                    const response = await fetch(`https://api.discord.id/${DISCORD_USER_ID}`);
                    const data = await response.json();
                    if (data) {
                        updateDiscordWidgetFallback(data);
                    }
                } catch (e) {
                    console.error('Fallback also failed:', e);
                }
            }
        }
        
        function updateDiscordWidgetDstn(data) {
            const statusIndicator = document.getElementById('statusIndicator');
            const discordStatusText = document.getElementById('discordStatusText');
            const discordUsername = document.getElementById('discordUsername');
            const discordAvatar = document.getElementById('discordAvatar');
            const avatar = document.getElementById('avatar');
            const discordActivity = document.getElementById('discordActivity');
            
            // Update avatar
            if (data.avatar) {
                const avatarUrl = data.avatar.url || `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar.id}.png?size=256`;
                discordAvatar.src = avatarUrl;
                avatar.src = avatarUrl;
            }
            
            // Update username
            if (data.username) {
                discordUsername.textContent = data.username;
            }
            
            // Update status
            const status = data.status || 'offline';
            statusIndicator.className = 'status-indicator';
            
            switch(status) {
                case 'online':
                    statusIndicator.classList.add('status-online');
                    discordStatusText.textContent = 'Online';
                    break;
                case 'idle':
                    statusIndicator.classList.add('status-idle');
                    discordStatusText.textContent = 'Idle';
                    break;
                case 'dnd':
                    statusIndicator.classList.add('status-dnd');
                    discordStatusText.textContent = 'Do Not Disturb';
                    break;
                default:
                    statusIndicator.classList.add('status-offline');
                    discordStatusText.textContent = 'Offline';
            }
            
            // Custom status
            if (data.custom_status && data.custom_status.text) {
                discordStatusText.textContent = data.custom_status.text;
            }
            
            // Activity
            if (data.activities && data.activities.length > 0) {
                const activity = data.activities.find(a => a.type !== 4);
                if (activity) {
                    discordActivity.style.display = 'block';
                    document.getElementById('activityName').textContent = activity.name || '';
                    document.getElementById('activityDetails').textContent = activity.details || '';
                    document.getElementById('activityState').textContent = activity.state || '';
                    
                    const activityImage = document.getElementById('activityImage');
                    if (activity.assets && activity.assets.large_image) {
                        activityImage.src = activity.assets.large_image;
                        activityImage.style.display = 'block';
                    } else {
                        activityImage.style.display = 'none';
                    }
                    
                    const activityHeader = discordActivity.querySelector('.activity-header');
                    switch(activity.type) {
                        case 0: activityHeader.textContent = 'Playing'; break;
                        case 1: activityHeader.textContent = 'Streaming'; break;
                        case 2: activityHeader.textContent = 'Listening to'; break;
                        case 3: activityHeader.textContent = 'Watching'; break;
                        case 5: activityHeader.textContent = 'Competing in'; break;
                        default: activityHeader.textContent = 'Playing';
                    }
                } else {
                    discordActivity.style.display = 'none';
                }
            } else {
                discordActivity.style.display = 'none';
            }
        }
        
        function updateDiscordWidgetFallback(data) {
            const discordUsername = document.getElementById('discordUsername');
            const discordAvatar = document.getElementById('discordAvatar');
            const avatar = document.getElementById('avatar');
            
            if (data.username) {
                discordUsername.textContent = data.username;
            }
            if (data.avatar) {
                const avatarUrl = `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png?size=256`;
                discordAvatar.src = avatarUrl;
                avatar.src = avatarUrl;
            }
        }
        
        // Old Lanyard updateDiscordWidget function removed - using updateDiscordWidgetDstn instead
        
        // Fetch status initially and every 30 seconds
        fetchDiscordStatus();
        setInterval(fetchDiscordStatus, 30000);
        
        // ============ COPY DISCORD ============
        function copyDiscord() {
            navigator.clipboard.writeText('altroll').then(() => {
                alert('Copied Discord username: altroll');
            });
        }
        
        // ============ PARALLAX CARD EFFECT ============
        const profileCard = document.getElementById('profileCard');
        
        profileCard.addEventListener('mousemove', (e) => {
            const rect = profileCard.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            
            const rotateX = (y - centerY) / 20;
            const rotateY = (centerX - x) / 20;
            
            profileCard.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
        });
        
        profileCard.addEventListener('mouseleave', () => {
            profileCard.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
        });
        
        // ============ ONEKO (Cat cursor) ============
        (function oneko() {
            const nekoEl = document.getElementById('oneko');
            let nekoPosX = 32;
            let nekoPosY = 32;
            let mousePosX = 0;
            let mousePosY = 0;
            let frameCount = 0;
            let idleTime = 0;
            let idleAnimation = null;
            let idleAnimationFrame = 0;
            const nekoSpeed = 10;
            const spriteSets = {
                idle: [[-3, -3]],
                alert: [[-7, -3]],
                scratchSelf: [[-5, 0], [-6, 0], [-7, 0]],
                scratchWallN: [[0, 0], [0, -1]],
                scratchWallS: [[-7, -1], [-6, -2]],
                scratchWallE: [[-2, -2], [-2, -3]],
                scratchWallW: [[-4, 0], [-4, -1]],
                tired: [[-3, -2]],
                sleeping: [[-2, 0], [-2, -1]],
                N: [[-1, -2], [-1, -3]],
                NE: [[0, -2], [0, -3]],
                E: [[-3, 0], [-3, -1]],
                SE: [[-5, -1], [-5, -2]],
                S: [[-6, -3], [-7, -2]],
                SW: [[-5, -3], [-6, -1]],
                W: [[-4, -2], [-4, -3]],
                NW: [[-1, 0], [-1, -1]]
            };

            function setSprite(name, frame) {
                const sprite = spriteSets[name][frame % spriteSets[name].length];
                nekoEl.style.backgroundPosition = `${sprite[0] * 32}px ${sprite[1] * 32}px`;
            }

            function resetIdleAnimation() {
                idleAnimation = null;
                idleAnimationFrame = 0;
            }

            function idle() {
                idleTime += 1;
                if (idleTime > 10 && Math.floor(Math.random() * 200) === 0 && idleAnimation === null) {
                    const availableIdleAnimations = ["sleeping", "scratchSelf"];
                    idleAnimation = availableIdleAnimations[Math.floor(Math.random() * availableIdleAnimations.length)];
                }

                switch (idleAnimation) {
                    case "sleeping":
                        if (idleAnimationFrame < 8) {
                            setSprite("tired", 0);
                            break;
                        }
                        setSprite("sleeping", Math.floor(idleAnimationFrame / 4));
                        if (idleAnimationFrame > 192) {
                            resetIdleAnimation();
                        }
                        break;
                    case "scratchSelf":
                        setSprite("scratchSelf", idleAnimationFrame);
                        if (idleAnimationFrame > 9) {
                            resetIdleAnimation();
                        }
                        break;
                    default:
                        setSprite("idle", 0);
                        return;
                }
                idleAnimationFrame += 1;
            }

            function frame() {
                frameCount += 1;
                const diffX = nekoPosX - mousePosX;
                const diffY = nekoPosY - mousePosY;
                const distance = Math.sqrt(diffX ** 2 + diffY ** 2);

                if (distance < nekoSpeed || distance < 48) {
                    idle();
                    return;
                }

                idleAnimation = null;
                idleAnimationFrame = 0;

                if (idleTime > 1) {
                    setSprite("alert", 0);
                    idleTime = Math.min(idleTime, 7);
                    idleTime -= 1;
                    return;
                }

                let direction = "";
                direction += diffY / distance > 0.5 ? "N" : "";
                direction += diffY / distance < -0.5 ? "S" : "";
                direction += diffX / distance > 0.5 ? "W" : "";
                direction += diffX / distance < -0.5 ? "E" : "";
                setSprite(direction, frameCount);

                nekoPosX -= (diffX / distance) * nekoSpeed;
                nekoPosY -= (diffY / distance) * nekoSpeed;

                nekoPosX = Math.min(Math.max(16, nekoPosX), window.innerWidth - 16);
                nekoPosY = Math.min(Math.max(16, nekoPosY), window.innerHeight - 16);

                nekoEl.style.left = `${nekoPosX - 16}px`;
                nekoEl.style.top = `${nekoPosY - 16}px`;
            }

            document.addEventListener("mousemove", function (event) {
                mousePosX = event.clientX;
                mousePosY = event.clientY;
            });

            nekoEl.style.left = `${nekoPosX - 16}px`;
            nekoEl.style.top = `${nekoPosY - 16}px`;

            setInterval(frame, 100);
        })();
    </script>
</body>
</html>
